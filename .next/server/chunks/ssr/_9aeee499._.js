module.exports=[17171,a=>{"use strict";a.s(["Label",()=>g],17171);var b=a.i(87924),c=a.i(72131),d=a.i(30553),e=c.forwardRef((a,c)=>(0,b.jsx)(d.Primitive.label,{...a,ref:c,onMouseDown:b=>{b.target.closest("button, input, select, textarea")||(a.onMouseDown?.(b),!b.defaultPrevented&&b.detail>1&&b.preventDefault())}}));e.displayName="Label";var f=a.i(97895);function g({className:a,...c}){return(0,b.jsx)(e,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...c})}},81502,a=>{"use strict";a.s(["default",()=>j]);var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(87682),i=a.i(54161);function j(){let[a,j]=(0,c.useState)([]),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(null);async function s(){n(!0);let a=await fetch("/api/auth/profile",{credentials:"include"}),b=await a.json();p(b.user?.role||"");let c=await fetch("/api/admin/users",{credentials:"include"});j((await c.json()).users||[]),l([{name:"user_management",description:"Create, update, delete users",roles:["SuperAdmin","Admin"]},{name:"product_management",description:"Manage gem listings and approvals",roles:["SuperAdmin","Admin","Moderator"]},{name:"order_management",description:"View and manage orders",roles:["SuperAdmin","Admin"]},{name:"audit_logs",description:"View audit logs",roles:["SuperAdmin","Admin"]},{name:"system_settings",description:"Configure system settings",roles:["SuperAdmin"]},{name:"financial_reports",description:"Access financial reports",roles:["SuperAdmin","Admin"]}]),n(!1)}async function t(a,b){let c=document.cookie.split("; ").find(a=>a.startsWith("csrfToken="))?.split("=")[1]||"",d=await fetch("/api/admin/users",{method:"PUT",headers:{"Content-Type":"application/json","x-csrf-token":c},credentials:"include",body:JSON.stringify({id:a,role:b})});return 401===d.status?void alert("Please re-authenticate for role changes."):d.ok?void await s():void r((await d.json()).error||"Failed to update role")}async function u(){let a=prompt("Re-enter your password for confirmation");a&&((await fetch("/api/auth/reauth",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:a})})).ok||alert("Re-authentication failed"))}return(0,c.useEffect)(()=>{s()},[]),(0,b.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between space-y-4 md:space-y-0",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-semibold",children:"System Settings"}),(0,b.jsx)(e.Button,{variant:"outline",onClick:u,children:"Re-authenticate"})]}),q&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:q}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Role Management"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Assign roles to users. Changes require re-authentication."}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"text-left border-b",children:[(0,b.jsx)("th",{className:"py-2",children:"User"}),(0,b.jsx)("th",{children:"Current Role"}),(0,b.jsx)("th",{children:"Status"}),(0,b.jsx)("th",{children:"Last Login"}),(0,b.jsx)("th",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:a.map(a=>(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium",children:[a.firstName," ",a.lastName]}),(0,b.jsx)("div",{className:"text-muted-foreground",children:a.email})]})}),(0,b.jsx)("td",{children:(0,b.jsx)(i.Badge,{variant:"SuperAdmin"===a.role?"default":"Admin"===a.role?"secondary":"outline",children:a.role})}),(0,b.jsx)("td",{children:a.isActive?"Active":"Suspended"}),(0,b.jsxs)("td",{className:"text-sm",children:[a.lastLogin?new Date(a.lastLogin).toLocaleDateString():"Never",a.loginCount>0&&(0,b.jsxs)("span",{className:"text-muted-foreground",children:[" ","(",a.loginCount," logins)"]})]}),(0,b.jsx)("td",{children:(0,b.jsxs)(h.Select,{defaultValue:a.role,onValueChange:b=>t(a._id||a.id||"",b),disabled:"admin@royalgems.com"===a.email,children:[(0,b.jsx)(h.SelectTrigger,{className:"w-[140px]",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"Moderator",children:"Moderator"}),(0,b.jsx)(h.SelectItem,{value:"Admin",children:"Admin"}),(0,b.jsx)(h.SelectItem,{value:"SuperAdmin",children:"SuperAdmin"})]})]})})]},a._id||a.id||a.email))})]})})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Permission Matrix"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Overview of permissions assigned to each role."}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"text-left border-b",children:[(0,b.jsx)("th",{className:"py-2",children:"Permission"}),(0,b.jsx)("th",{children:"Description"}),(0,b.jsx)("th",{children:"Moderator"}),(0,b.jsx)("th",{children:"Admin"}),(0,b.jsx)("th",{children:"SuperAdmin"})]})}),(0,b.jsx)("tbody",{children:k.map(a=>(0,b.jsxs)("tr",{className:"border-b",children:[(0,b.jsx)("td",{className:"py-2 font-medium",children:a.name.replace("_"," ")}),(0,b.jsx)("td",{className:"text-muted-foreground",children:a.description}),(0,b.jsx)("td",{children:a.roles.includes("Moderator")?"✓":"✗"}),(0,b.jsx)("td",{children:a.roles.includes("Admin")?"✓":"✗"}),(0,b.jsx)("td",{children:a.roles.includes("SuperAdmin")?"✓":"✗"})]},a.name))})]})})]})})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:"Security Settings"})}),(0,b.jsx)(d.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-1 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Session Timeout (minutes)"}),(0,b.jsx)(f.Input,{type:"number",defaultValue:"60",disabled:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Currently fixed at 60 minutes"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Failed Login Attempts"}),(0,b.jsx)(f.Input,{type:"number",defaultValue:"5",disabled:!0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Account locks after 5 failed attempts"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"Password Requirements"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["• Minimum 12 characters",(0,b.jsx)("br",{}),"• Uppercase, lowercase, number, special character"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(g.Label,{children:"2FA Required"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["• Mandatory for Admin and SuperAdmin roles",(0,b.jsx)("br",{}),"• Optional for Moderator role"]})]})]})})})]})]})}}];

//# sourceMappingURL=_9aeee499._.js.map