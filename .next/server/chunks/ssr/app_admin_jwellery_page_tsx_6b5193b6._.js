module.exports=[51487,a=>{"use strict";a.s(["default",()=>u]);var b=a.i(87924),c=a.i(72131),d=a.i(3130),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(87682),i=a.i(54161),j=a.i(67304),k=a.i(15618),l=a.i(87532),m=a.i(68976),n=a.i(81560),o=a.i(77156),p=a.i(41379),q=a.i(38632),r=a.i(69520);function s(a){let b=Array.isArray(a?.images)?a.images:[];return{...a,images:b,image_url:a?.image_url??b[0]??"",stock_quantity:"number"==typeof a?.stock_quantity?a.stock_quantity:0,is_active:!!a?.is_active,price:"number"==typeof a?.price?a.price:Number(a?.price||0),created_at:a?.created_at??new Date().toISOString()}}function t(){return document.cookie.split("; ").find(a=>a.startsWith("csrfToken="))?.split("=")[1]||""}function u(){let[a,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)("All"),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)({name:"",price:0,stock_quantity:0,is_active:!0,metal_type_purity:"",gross_weight_grams:"",gemstone_type:"",carat_weight:"",cut_and_shape:"",color_and_clarity:"",report_number:"",report_date:"",authorized_seal_signature:"",image_url:""}),[J,K]=(0,c.useState)(null),[L,M]=(0,c.useState)(!1);async function N(){w(!0),A(null);try{let a=await fetch("/api/admin/jwellery",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!a.ok)throw Error("Failed to fetch jwellery");let b=await a.json(),c=Array.isArray(b?.jwellery)?b.jwellery:[];u(c.map(s))}catch(a){A(a?.message||"Failed to fetch jwellery")}finally{w(!1)}}(0,c.useEffect)(()=>{N()},[]);let O=(0,c.useMemo)(()=>{let b=[...a];if(B.trim()){let a=B.trim().toLowerCase();b=b.filter(b=>[b.name,b.metal_type_purity,b.report_number,b.gemstone_type].filter(Boolean).join(" ").toLowerCase().includes(a))}return"Active"===D?b=b.filter(a=>a.is_active):"Inactive"===D&&(b=b.filter(a=>!a.is_active)),b},[a,B,D]);function P(){G(null),K(null),I({name:"",price:0,stock_quantity:0,is_active:!0,metal_type_purity:"",gross_weight_grams:"",gemstone_type:"",carat_weight:"",cut_and_shape:"",color_and_clarity:"",report_number:"",report_date:"",authorized_seal_signature:"",image_url:""}),A(null)}async function Q(a){let b=new FormData;b.append("file",a),b.append("folder","jwellery");let c=t(),d=await fetch("/api/admin/upload",{method:"POST",headers:{"x-csrf-token":c},body:b,credentials:"include"});if(!d.ok){let a=await d.json().catch(()=>({}));throw Error(a?.error||"Failed to upload image")}return(await d.json()).url}async function R(){y(!0),A(null);try{let a=H.image_url;if(J){M(!0);try{a=await Q(J)}finally{M(!1)}}let b={name:H.name,price:Number(H.price),stock_quantity:Number(H.stock_quantity)||0,is_active:!!H.is_active,metal_type_purity:H.metal_type_purity||void 0,gross_weight_grams:""!==H.gross_weight_grams?Number(H.gross_weight_grams):void 0,gemstone_type:H.gemstone_type||void 0,carat_weight:""!==H.carat_weight?Number(H.carat_weight):void 0,cut_and_shape:H.cut_and_shape||void 0,color_and_clarity:H.color_and_clarity||void 0,report_number:H.report_number||void 0,report_date:H.report_date||void 0,authorized_seal_signature:H.authorized_seal_signature||void 0,images:a?[a]:[]},c=t();if(F){let a=await fetch("/api/admin/jwellery",{method:"PUT",headers:{"Content-Type":"application/json","x-csrf-token":c},credentials:"include",body:JSON.stringify({id:F.id,...b})});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b?.error||"Failed to update jwellery")}let d=s(await a.json());u(a=>a.map(a=>a.id===d.id?d:a)),P()}else{let a=await fetch("/api/admin/jwellery",{method:"POST",headers:{"Content-Type":"application/json","x-csrf-token":c},credentials:"include",body:JSON.stringify(b)});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b?.error||"Failed to create jwellery")}let d=s(await a.json());u(a=>[d,...a]),P()}}catch(a){A(a?.message||"Failed to save jwellery")}finally{y(!1),M(!1)}}async function S(a){if(confirm(`Are you sure you want to delete "${a.name}"?`)){y(!0),A(null);try{let b=t(),c=await fetch(`/api/admin/jwellery?id=${a.id}`,{method:"DELETE",headers:{"x-csrf-token":b},credentials:"include"});if(!c.ok){let a=await c.json().catch(()=>({}));throw Error(a?.error||"Failed to delete jwellery")}u(b=>b.filter(b=>b.id!==a.id)),F?.id===a.id&&P()}catch(a){A(a?.message||"Failed to delete jwellery")}finally{y(!1)}}}async function T(a){y(!0),A(null);try{let b=t(),c=await fetch("/api/admin/jwellery",{method:"PUT",headers:{"Content-Type":"application/json","x-csrf-token":b},credentials:"include",body:JSON.stringify({id:a.id,is_active:!a.is_active})});if(!c.ok){let a=await c.json().catch(()=>({}));throw Error(a?.error||"Failed to update status")}let d=s(await c.json());u(a=>a.map(a=>a.id===d.id?d:a))}catch(a){A(a?.message||"Failed to update status")}finally{y(!1)}}return(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(j.Diamond,{className:"h-7 w-7"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Jwellery"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage your certified jwellery products"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(e.Button,{variant:"outline",onClick:N,disabled:v,children:[(0,b.jsx)(r.RefreshCw,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),"Refresh"]}),(0,b.jsxs)(e.Button,{onClick:P,variant:"secondary",children:[(0,b.jsx)(k.Plus,{className:"h-4 w-4 mr-2"}),"New"]})]})]}),z?(0,b.jsx)(d.Card,{className:"border-red-500/30",children:(0,b.jsx)(d.CardContent,{className:"py-4 text-red-600",children:z})}):null,(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)(d.CardTitle,{children:F?"Edit Jwellery":"Add New Jwellery"})}),(0,b.jsxs)(d.CardContent,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Name"}),(0,b.jsx)(f.Input,{value:H.name,onChange:a=>I(b=>({...b,name:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Price"}),(0,b.jsx)(f.Input,{type:"number",value:H.price,onChange:a=>I(b=>({...b,price:Number(a.target.value)}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Stock Quantity"}),(0,b.jsx)(f.Input,{type:"number",value:H.stock_quantity,onChange:a=>I(b=>({...b,stock_quantity:Number(a.target.value)}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Metal Type & Purity"}),(0,b.jsx)(f.Input,{value:H.metal_type_purity,onChange:a=>I(b=>({...b,metal_type_purity:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Gross Weight (g)"}),(0,b.jsx)(f.Input,{type:"number",value:H.gross_weight_grams,onChange:a=>I(b=>({...b,gross_weight_grams:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Gemstone Type (Natural/Synthetic)"}),(0,b.jsx)(f.Input,{value:H.gemstone_type,onChange:a=>I(b=>({...b,gemstone_type:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Carat Weight (cts)"}),(0,b.jsx)(f.Input,{type:"number",value:H.carat_weight,onChange:a=>I(b=>({...b,carat_weight:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Cut & Shape"}),(0,b.jsx)(f.Input,{value:H.cut_and_shape,onChange:a=>I(b=>({...b,cut_and_shape:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Color & Clarity"}),(0,b.jsx)(f.Input,{value:H.color_and_clarity,onChange:a=>I(b=>({...b,color_and_clarity:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Report Number"}),(0,b.jsx)(f.Input,{value:H.report_number,onChange:a=>I(b=>({...b,report_number:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Report Date"}),(0,b.jsx)(f.Input,{type:"date",value:H.report_date,onChange:a=>I(b=>({...b,report_date:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Authorized Seal & Signature"}),(0,b.jsx)(f.Input,{value:H.authorized_seal_signature,onChange:a=>I(b=>({...b,authorized_seal_signature:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2 md:col-span-2 lg:col-span-3",children:[(0,b.jsxs)(g.Label,{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Image,{className:"h-4 w-4"})," Product Image"]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-3",children:[(0,b.jsx)(f.Input,{type:"file",accept:"image/*",onChange:a=>K(a.target.files?.[0]||null)}),(0,b.jsx)(f.Input,{placeholder:"Or paste image URL",value:H.image_url,onChange:a=>I(b=>({...b,image_url:a.target.value}))})]}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:"Upload uses the same storage bucket as gems."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{children:"Status"}),(0,b.jsxs)(h.Select,{value:H.is_active?"active":"inactive",onValueChange:a=>I(b=>({...b,is_active:"active"===a})),children:[(0,b.jsx)(h.SelectTrigger,{children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(h.SelectItem,{value:"inactive",children:"Inactive"})]})]})]})]}),(0,b.jsxs)("div",{className:"mt-5 flex items-center gap-2",children:[(0,b.jsx)(e.Button,{onClick:R,disabled:x||L||!H.name,children:x?"Saving...":F?"Update":"Create"}),(0,b.jsx)(e.Button,{variant:"outline",onClick:P,children:"Cancel"}),L?(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Uploading image..."}):null]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[(0,b.jsx)(d.CardTitle,{children:"Items"}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Search,{className:"h-4 w-4 absolute left-3 top-3 text-muted-foreground"}),(0,b.jsx)(f.Input,{className:"pl-9 w-72",placeholder:"Search...",value:B,onChange:a=>C(a.target.value)})]}),(0,b.jsxs)(h.Select,{value:D,onValueChange:a=>E(a),children:[(0,b.jsx)(h.SelectTrigger,{className:"w-44",children:(0,b.jsx)(h.SelectValue,{})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"All",children:"All"}),(0,b.jsx)(h.SelectItem,{value:"Active",children:"Active"}),(0,b.jsx)(h.SelectItem,{value:"Inactive",children:"Inactive"})]})]})]})]})}),(0,b.jsx)(d.CardContent,{children:v?(0,b.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"Loading..."}):0===O.length?(0,b.jsx)("div",{className:"py-8 text-center text-muted-foreground",children:"No items found."}):(0,b.jsx)("div",{className:"space-y-3",children:O.map(a=>(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-md bg-muted overflow-hidden flex items-center justify-center",children:a.image_url?(0,b.jsx)("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover"}):(0,b.jsx)(q.Image,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-semibold",children:a.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["$",a.price," â€¢ Stock: ",a.stock_quantity]}),(0,b.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,b.jsx)(i.Badge,{variant:a.is_active?"default":"secondary",children:a.is_active?"Active":"Inactive"}),a.metal_type_purity?(0,b.jsx)(i.Badge,{variant:"outline",children:a.metal_type_purity}):null,a.report_number?(0,b.jsxs)(i.Badge,{variant:"outline",children:["Report: ",a.report_number]}):null]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(e.Button,{size:"sm",variant:"outline",onClick:()=>{G(a),K(null),I({name:a.name,price:a.price,stock_quantity:a.stock_quantity,is_active:a.is_active,metal_type_purity:a.metal_type_purity||"",gross_weight_grams:void 0!==a.gross_weight_grams&&null!==a.gross_weight_grams?String(a.gross_weight_grams):"",gemstone_type:a.gemstone_type||"",carat_weight:void 0!==a.carat_weight&&null!==a.carat_weight?String(a.carat_weight):"",cut_and_shape:a.cut_and_shape||"",color_and_clarity:a.color_and_clarity||"",report_number:a.report_number||"",report_date:a.report_date||"",authorized_seal_signature:a.authorized_seal_signature||"",image_url:a.image_url||a.images?.[0]||""}),A(null)},children:[(0,b.jsx)(m.Edit3,{className:"h-4 w-4 mr-2"})," Edit"]}),(0,b.jsx)(e.Button,{size:"sm",variant:"outline",onClick:()=>T(a),disabled:x,children:a.is_active?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.EyeOff,{className:"h-4 w-4 mr-2"})," Hide"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Eye,{className:"h-4 w-4 mr-2"})," Show"]})}),(0,b.jsx)(e.Button,{size:"sm",variant:"destructive",onClick:()=>S(a),disabled:x,children:(0,b.jsx)(n.Trash2,{className:"h-4 w-4"})})]})]},a.id))})})]})]})}}];

//# sourceMappingURL=app_admin_jwellery_page_tsx_6b5193b6._.js.map